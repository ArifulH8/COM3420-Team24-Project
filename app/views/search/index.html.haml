%html{:lang => "en"}
  %head
!!!
%html
  %head
    %meta{:charset => "utf-8"}/
    %title Login
    %meta{:charset => "utf-8"}/
    %meta{:content => "width=device-width, initial-scale=1, shrink-to-fit=no", :name => "viewport"}/
    %link{:href => "https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap", :rel => "stylesheet"}/
    = javascript_pack_tag "ecf_preview"
  %body-1
    %section.ftco-section


      .container.animate__animated.animate__fadeIn
        .row.justify-content-center
          .col-md-6.text-center.mb-5
            %h2.heading-section Listing ECFs
        .row.justify-content-center
          .ecf-preview
            .row
              .col
                %p.txt-centre#col1
                  There are
                  %span#num1 #{@ecfs.size}
                  ecfs.

              = search_form_for(@q, url: search_index_path, method: :get) do |f|
                = f.label "Ecf status"
                = f.search_field :status_cont
                
                = f.label "Student Username"
                = f.search_field :user_uid_cont
          
                = f.submit "Search"

            %table.table
            -if @ecfs.empty?
              %p.alert.alert-primary There are no current ECFs !
            -else
              %table.table
                %thead
                  %tr
                    %th{:scope => "col"} Status
                    %th{:scope => "col"} Date Submitted
                    %th{:scope => "col"} Student Full Name
                    %th{:scope => "col"} Student Email
                    %th{:scope => "col"} Student Username
                %tbody
                  - @ecfs.each do |ecf|
                    %tr
                      %td= ecf.status
                      %td= ecf.date
                      %td #{ecf.user.givenname} #{ecf.user.sn}
                      %td= ecf.user.mail
                      %td= ecf.user.uid
                      %td= link_to 'Show', ecf
                      %td= link_to 'Edit', edit_ecf_path(ecf)


